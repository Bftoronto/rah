# Настройка Telegram бота для приложения поиска попутчиков PAX

## Пошаговая инструкция

### 1. Создание бота через @BotFather

1. Откройте Telegram и найдите @BotFather
2. Отправьте команду `/newbot`
3. Введите название бота (например: "PAX - Поиск попутчиков")
4. Введите username бота (например: "pax_rides_bot")
5. Сохраните токен бота для дальнейшего использования

### 2. Настройка мини-приложения

1. Отправьте @BotFather команду `/mybots`
2. Выберите созданного бота
3. Нажмите "Bot Settings" → "Menu Button"
4. Введите URL вашего мини-приложения (например: `https://yourdomain.com/pax-app/`)
5. Сохраните настройки

### 3. Альтернативный способ через команды

```
/newapp - создать новое мини-приложение
/setmenubutton - установить кнопку меню
```

### 4. Примеры команд для настройки

```bash
# Установка кнопки меню
/setmenubutton

# Настройка команд бота
/setcommands

# Добавление описания
/setdescription

# Добавление информации о боте
/setabouttext
```

### 5. Рекомендуемые команды для бота

```
start - Начать поиск попутчиков
search - Поиск поездок
mytrips - Мои поездки
profile - Мой профиль
help - Помощь
```

### 6. Настройка веб-сервера

#### Требования:
- HTTPS протокол (обязательно для Telegram)
- Поддержка статических файлов
- CORS настройки (если необходимо)

#### Пример настройки nginx:
```nginx
server {
    listen 443 ssl;
    server_name yourdomain.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    location /pax-app/ {
        root /var/www/html;
        index index.html;
        try_files $uri $uri/ /pax-app/index.html;
    }
}
```

### 7. Функциональность приложения

#### Основные экраны:
- **Ограничение доступа** - при нулевом балансе
- **Поиск поездок** - форма с полями "откуда", "куда", дата, количество мест
- **Результаты поиска** - список доступных поездок с деталями
- **Профиль водителя** - рейтинг, отзывы, информация о водителе
- **Способы оплаты** - выбор метода пополнения баланса
- **Выбор банка** - для СБП платежей
- **Успешная оплата** - подтверждение бронирования
- **Регистрация** - пошаговая верификация (10 шагов)
- **Профиль пользователя** - баланс, статистика, настройки
- **Мои поездки** - история забронированных и созданных поездок

#### API эндпоинты (мок-данные):
- `getUserData()` - получение данных пользователя
- `getRides(from, to, date)` - поиск поездок
- `bookRide(rideId)` - бронирование поездки
- `createRide(rideData)` - создание новой поездки
- `processPayment(amount, method)` - обработка платежа
- `getMyRides()` - получение истории поездок

### 8. Тестирование

1. Откройте бота в Telegram
2. Нажмите кнопку "Menu" или отправьте команду `/start`
3. Проверьте работу всех функций приложения:
   - Поиск поездок между городами
   - Просмотр деталей поездки
   - Бронирование поездки
   - Просмотр профиля
   - История поездок
   - Система оплаты и пополнения баланса

### 9. Полезные ссылки

- [Telegram Bot API Documentation](https://core.telegram.org/bots/api)
- [Telegram Web App Documentation](https://core.telegram.org/bots/webapps)
- [BotFather Commands](https://core.telegram.org/bots#botfather-commands)

### 10. Отладка

#### Проверка в браузере:
```javascript
// Проверка доступности Telegram Web App API
if (window.Telegram && window.Telegram.WebApp) {
    console.log('Telegram Web App API доступен');
    console.log('User:', tg.initDataUnsafe?.user);
    console.log('Chat:', tg.initDataUnsafe?.chat);
    console.log('Start Param:', tg.initDataUnsafe?.start_param);
} else {
    console.log('Запущено вне Telegram');
}
```

#### Логи для отладки:
```javascript
// Добавьте в index.html для отладки
console.log('User:', tg.initDataUnsafe?.user);
console.log('Chat:', tg.initDataUnsafe?.chat);
console.log('Start Param:', tg.initDataUnsafe?.start_param);
```

### 11. Безопасность

- Всегда используйте HTTPS
- Проверяйте подпись данных от Telegram
- Не храните чувствительные данные в localStorage
- Используйте токены доступа для API вызовов
- Валидируйте данные поиска на сервере

### 12. Специфика приложения поиска попутчиков

#### Рекомендуемые настройки бота:
- **Описание**: "Найдите попутчиков для поездки между городами России"
- **О боте**: "RAH - удобный сервис для поиска попутчиков. Бронируйте поездки, находите водителей и экономьте на путешествиях."
- **Команды**: Настройте команды для быстрого доступа к основным функциям

#### Особенности интеграции:
- Используйте данные пользователя Telegram для автозаполнения профиля
- Интегрируйте с геолокацией для определения города пользователя
- Добавьте уведомления о статусе бронирования

#### Система баланса:
- Приложение использует внутреннюю систему баланса
- При нулевом балансе показывается экран ограничения доступа
- Поддерживается пополнение через СБП и банковские карты

#### Верификация пользователей:
- 10-шаговая система регистрации
- Верификация паспорта, телефона и автомобиля
- Система рейтингов и отзывов