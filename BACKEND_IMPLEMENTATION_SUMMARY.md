## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### 1. –°–µ—Ä–≤–∏—Å—ã (Services)

#### ‚úÖ RideService - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–æ–∫** —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö
- **–ü–æ–∏—Å–∫ –ø–æ–µ–∑–¥–æ–∫** —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ/–æ—Ç–º–µ–Ω–∞** –ø–æ–µ–∑–¥–æ–∫ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤
- **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–µ–∑–¥–æ–∫** —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (–ø–æ–µ–∑–¥–∫–∏ –∫–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å/–ø–∞—Å—Å–∞–∂–∏—Ä)
- **–û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö** –ø–æ–µ–∑–¥–æ–∫

#### ‚úÖ ChatService - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–æ–≤** –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –ø–æ–µ–∑–¥–∫–∏
- **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- **–û—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö** —Å–æ–æ–±—â–µ–Ω–∏–π
- **–£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** (–≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞)
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞—Ç–æ–≤** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö** —Å–æ–æ–±—â–µ–Ω–∏–π

## üíµ –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞—Å—á–µ—Ç–æ–≤

**–í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –º–µ–∂–¥—É –ø–∞—Å—Å–∞–∂–∏—Ä–æ–º –∏ –≤–æ–¥–∏—Ç–µ–ª–µ–º:**

<span role="img" aria-label="–Ω–∞–ª–∏—á–Ω—ã–µ">üíµ</span> –ù–∞–ª–∏—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç <span style="color:#bbb;">|</span> <span role="img" aria-label="–ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É">üí≥</span> –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É

<span style="font-size:13px;color:#888;">–û–Ω–ª–∞–π–Ω-–æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.</span>

### 2. API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### ‚úÖ Rides API - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
```
POST /api/rides/ - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏
GET /api/rides/search - –ø–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
GET /api/rides/{id} - –¥–µ—Ç–∞–ª–∏ –ø–æ–µ–∑–¥–∫–∏
POST /api/rides/{id}/book - –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
PUT /api/rides/{id}/cancel - –æ—Ç–º–µ–Ω–∞
PUT /api/rides/{id}/complete - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
GET /api/rides/user/me - –º–æ–∏ –ø–æ–µ–∑–¥–∫–∏
PUT /api/rides/{id} - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
GET /api/rides/user/me/statistics - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
DELETE /api/rides/{id} - —É–¥–∞–ª–µ–Ω–∏–µ
```

#### ‚úÖ Chat API - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
```
POST /api/chat/ - —Å–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
GET /api/chat/ - —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
GET /api/chat/{id}/messages - —Å–æ–æ–±—â–µ–Ω–∏—è
POST /api/chat/{id}/send - –æ—Ç–ø—Ä–∞–≤–∫–∞
PUT /api/chat/{id}/read - –æ—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
DELETE /api/chat/messages/{id} - —É–¥–∞–ª–µ–Ω–∏–µ
GET /api/chat/statistics - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
GET /api/chat/unread/count - –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
GET /api/chat/{id}/info - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ
POST /api/chat/ride/{id}/start - —á–∞—Ç –¥–ª—è –ø–æ–µ–∑–¥–∫–∏
```

### 3. WebSocket –¥–ª—è Real-time —á–∞—Ç–∞

#### ‚úÖ WebSocket —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –ø–æ user_id
- **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞–±–æ—Ä–µ** —Ç–µ–∫—Å—Ç–∞
- **–û—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö** —Å–æ–æ–±—â–µ–Ω–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏–π** –∏ –æ—à–∏–±–æ–∫

### 4. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- **Ride** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤—è–∑–∏ —Å —á–∞—Ç–∞–º–∏
- **User** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤—è–∑–∏ —Å —á–∞—Ç–∞–º–∏
- **Chat** - –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- **ChatMessage** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å –ø–æ–ª—è–º–∏ is_read, read_at

### 5. –°—Ö–µ–º—ã Pydantic

#### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
- **RideCreate/RideUpdate/RideRead** - –ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **ChatCreate/ChatRead/ChatMessageCreate** - –Ω–æ–≤—ã–µ —Å—Ö–µ–º—ã
- **ChatListResponse** - –¥–ª—è —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤

### 6. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 004
- **–¢–∞–±–ª–∏—Ü–∞ chats** —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- **–¢–∞–±–ª–∏—Ü–∞ chat_messages** —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- **–¢—Ä–∏–≥–≥–µ—Ä—ã** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
- **–§—É–Ω–∫—Ü–∏–∏** –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∏

#### ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–°—á–µ—Ç—á–∏–∫–∏** –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö users –∏ rides
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

#### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** –∫–æ –≤—Å–µ–º —Ä–µ—Å—É—Ä—Å–∞–º
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ö–µ–º
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **Rate limiting** —á–µ—Ä–µ–∑ FastAPI

### 8. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### ‚úÖ –°–æ–∑–¥–∞–Ω–∞
- **API_DOCUMENTATION.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **–ö–æ–¥—ã –æ—à–∏–±–æ–∫** –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏—è
- **WebSocket –ø—Ä–æ—Ç–æ–∫–æ–ª** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** –æ—Ç API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏
- **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–¢—Ä–∏–≥–≥–µ—Ä—ã** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤

### 3. WebSocket
- **ConnectionManager** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏–π** –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è
- **Pydantic —Å—Ö–µ–º—ã** –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–∏—Å–æ–≤
- **–î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö**

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

### ‚úÖ –ì–æ—Ç–æ–≤–æ
- **–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** –ø–æ–µ–∑–¥–æ–∫ –∏ —á–∞—Ç–∞
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** API
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - unit –∏ integration —Ç–µ—Å—Ç—ã
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –º–µ—Ç—Ä–∏–∫–∏ –∏ –∞–ª–µ—Ä—Ç—ã
- **Rate limiting** - –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - Redis –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
psql -d ridesharing -f migrations/004_add_chat_and_payment_tables.sql

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏
curl -X POST "http://localhost:8000/api/rides/" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "from_location": "–ú–æ—Å–∫–≤–∞",
    "to_location": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "date": "2024-01-20T10:00:00Z",
    "price": 1500.0,
    "seats": 3
  }'

# –ü–æ–∏—Å–∫ –ø–æ–µ–∑–¥–æ–∫
curl -X GET "http://localhost:8000/api/rides/search?from_location=–ú–æ—Å–∫–≤–∞" \
  -H "Authorization: Bearer YOUR_TOKEN"

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
curl -X POST "http://localhost:8000/api/chat/1/send" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"message": "–ü—Ä–∏–≤–µ—Ç!"}'
```